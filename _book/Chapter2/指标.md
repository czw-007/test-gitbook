# 性能测试指标

### 响应时间   
+ 网络传输时间+服务器处理时间
+ 原则：2-5-8   优秀-良好--较差


### tps  每秒处理的事务数    transaction per second
+ 事务: 登陆，注册，订单，修改密码

### QPS 每秒点击数Hits Per Second 
+ 每秒点击数是指每秒钟像web服务器提交的HTTP请求数，它是衡量服务器处理能力的一个常用指标。需要注意的是，这里的相应时间并非鼠标的一次单击操作，因为在一次单击操作中，客户端可能向服务器发出多个HTTP请求，切勿混淆。
  + 理解了上面三个要素的意义之后，就能推算出它们之间的关系：

     QPS（TPS）= 并发数/平均响应时间

    并发数 = QPS*平均响应时间 



### 事务成功率；  事务是定义的一个业务。事务是自己定义的。


### 吞吐率
+ 吞吐率通常指单位时间内从服务器返回的字节数，也可以单位时间内客户提交的请求数。吞吐率是大型web系统衡量自身负载能力的一个重要指标，一般来说，吞吐率越大，单位时间内处理的数据就越多，系统的负载能力也强。吞吐率与很多因素有关，服务器的硬件配置，网络的宽带及拓扑结构，软件的技术架构等。


### 资源利用率： 在一定的负载情况下，服务器资源占用情况
+ CPU利用率  不允许超过70-80% 
+ Mem利用率  80%以下
+ 带宽利用率  100Mbps=12.5MB/s   1Byte=8bit        
+ 如果资源利用率太小，造成资源浪费


### 用户数  ：并发用户数    
+ 在同一时间向服务器发送请求的用户数量与每秒的并发请求数不同，一定要确认需求的目的是并发用户数还是并发请求数

## 实际举例
我们通过一个实例来把上面几个概念串起来理解。按二八定律来看，如果每天 80% 的访问集中在 20% 的时间里，这 20% 时间就叫做峰值时间。
公式：( 总PV数 * 80% ) / ( 每天秒数 * 20% ) = 峰值时间每秒请求数(QPS)
机器：峰值时间每秒QPS / 单台机器的QPS = 需要的机器
1、每天300w PV 的在单台机器上，这台机器需要多少QPS？ 
( 3000000 * 0.8 ) / (86400 * 0.2 ) = 139 (QPS)
2、如果一台机器的QPS是58，需要几台机器来支持？ 
139 / 58 = 3

最佳线程数量
刚好消耗完服务器的瓶颈资源的临界线程数，公式如下
最佳线程数量=（（线程等待时间+线程cpu时间）/线程cpu时间）* cpu数量
特性：
在达到最佳线程数的时候，线程数量继续递增，则QPS不变，而响应时间变长，持续递增线程数量，则QPS开始下降。
每个系统都有其最佳线程数量，但是不同状态下，最佳线程数量是会变化的。
瓶颈资源可以是CPU,可以是内存，可以是锁资源，IO资源：超过最佳线程数-导致资源的竞争，超过最佳线程数-响应时间递增。

典型的性能测试场景
性能测试比较重要的其实是：性能测试场景分析、测试结果分析、调优建议等

+ 01
用户提出的一些性能要求；例如，网站首页页面响应时间在3S之内，主要的业务操作时间小于10s，支持300用户在线操作等相关语言描述。

+ 02
某个软件产品要发布了，需要对用户做集中的培训/演示/开始大力推广。通常在进行培训的时候，老师讲解完成一个业务之后，被培训的人员根据老师讲解的实例进行同步操作前面讲过的业务，这样存在用户并发的问题。在培训之前搭建环境的时候，应该要考虑被培训的人数，以便在场景中设计合理的并发用户数量。
+ 03
在同一个系统中可以采用两种不同的架构，比如.NET或者JAVA，决定该系统到底需要采用那个架构，因为同样的系统不同的语言，架构的实现效果可能就会不一样，为了系统有更好的性能表现，在系统的实现前期，可以通过设计一个比较小的DEMO实例，设计同样的场景，实际考察不同的语言，不同框架之间的性能差异，从而决定选择性能较好的语言，框架开发软件产品。
+ 04
编码完成，总是觉着系统的某个部分开发的有点问题，但是有说不清楚什么地方到底存在性能上的瓶颈。一个优秀的系统软件是需要开发、测试人员以及数据库管理员、系统管理员等角色协同工作才能够完成的。开发人员遇到性能问题以后需要提出需求，性能测试人员需要设计相关的场景，分析系统存在的瓶颈，定位相关的问题之后，将分析的测试结果以及意见反馈到开发等相关人员，作为开发相关人员作为调整的相关依据，调整以后，再根据相同的环境、同场景的测试，直到使系统能够达到相关预期的目标。
+ 05
决定门户网站能够支持多大的并发操作（注册、写博客、看照片、灌水等等）。一个门户网站是应该经得起考验的。门户网站栏目众多，在进行性能测试的时候，需要考虑不同的应用场景，将注册用户、写博客、看照片、看新闻等用户操作设计成相应的场景，根据预期的用户数量设计相应的并发量。一个好的网站随着用户数量的逐渐增长以及推广的深入，访问量可能会成几何级数的增长。考虑门户网站的这些特点，在进行性能测试的时候，需要考虑可靠性测试，失败测试以及安全性测试等。

### 性能测试通过的标准：
![节点](http://note.youdao.com/yws/res/255/WEBRESOURCE04fdb7c2ab7d7b037646534558581d6e)

![节点](http://note.youdao.com/yws/res/190/WEBRESOURCE3439cbfbd57a11a0a6927c9189a7f50e)




